2025-06-10 01:23:22 | ERROR    | core.integrations.openai_client:_initialize:48 - ❌ Ошибка инициализации OpenAI клиента: AsyncClient.__init__() got an unexpected keyword argument 'proxies'
2025-06-10 01:23:23 | ERROR    | storage.database:initialize:45 - ❌ Ошибка инициализации БД: role "postgres" does not exist
2025-06-10 01:27:23 | ERROR    | core.integrations.openai_client:_initialize:78 - ❌ Ошибка инициализации OpenAI клиента: AsyncClient.__init__() got an unexpected keyword argument 'proxies'
2025-06-10 01:27:23 | ERROR    | core.integrations.openai_client:_initialize:78 - ❌ Ошибка инициализации OpenAI клиента: AsyncClient.__init__() got an unexpected keyword argument 'proxies'
2025-06-10 01:27:24 | ERROR    | storage.database:health_check:67 - ❌ Health check БД провален: Textual SQL expression 'SELECT 1' should be explicitly declared as text('SELECT 1')
2025-06-10 01:31:54 | ERROR    | core.integrations.openai_client:_initialize:78 - ❌ Ошибка инициализации OpenAI клиента: AsyncClient.__init__() got an unexpected keyword argument 'proxies'
2025-06-10 01:31:54 | ERROR    | core.integrations.openai_client:_initialize:78 - ❌ Ошибка инициализации OpenAI клиента: AsyncClient.__init__() got an unexpected keyword argument 'proxies'
2025-06-10 01:33:35 | ERROR    | core.integrations.openai_client:_initialize:74 - ❌ Ошибка инициализации OpenAI клиента: AsyncClient.__init__() got an unexpected keyword argument 'proxies'
2025-06-10 01:33:35 | ERROR    | core.integrations.openai_client:_initialize:74 - ❌ Ошибка инициализации OpenAI клиента: AsyncClient.__init__() got an unexpected keyword argument 'proxies'
2025-06-10 01:40:20 | ERROR    | core.integrations.telegram_client:_check_session_auth:143 - ❌ Ошибка проверки авторизации vitalikbuter1n: database is locked
2025-06-10 01:40:25 | ERROR    | core.integrations.telegram_client:_check_session_auth:143 - ❌ Ошибка проверки авторизации natasafi: database is locked
2025-06-10 01:40:30 | ERROR    | core.integrations.telegram_client:_check_session_auth:143 - ❌ Ошибка проверки авторизации antocastano: database is locked
2025-06-10 02:57:24 | ERROR    | bot.handlers.sessions.sessions:session_dialogs:364 - ❌ Ошибка загрузки диалогов сессии: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column conversations.is_whitelisted does not exist
[SQL: SELECT conversations.id, conversations.lead_id, conversations.session_id, conversations.status, conversations.current_stage, conversations.ref_link_sent, conversations.ref_link_sent_at, conversations.converted, conversations.converted_at, conversations.messages_count, conversations.user_messages_count, conversations.assistant_messages_count, conversations.avg_response_time, conversations.last_user_message_at, conversations.last_assistant_message_at, conversations.context_summary, conversations.lead_analysis, conversations.is_whitelisted, conversations.is_blacklisted, conversations.auto_created, conversations.requires_approval, conversations.ai_disabled, conversations.auto_responses_paused, conversations.created_at, conversations.updated_at 
FROM conversations 
WHERE conversations.session_id = $1::INTEGER ORDER BY conversations.updated_at DESC 
 LIMIT $2::INTEGER]
[parameters: (8, 10)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-10 02:57:26 | ERROR    | bot.handlers.sessions.sessions:session_dialogs:364 - ❌ Ошибка загрузки диалогов сессии: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column conversations.is_whitelisted does not exist
[SQL: SELECT conversations.id, conversations.lead_id, conversations.session_id, conversations.status, conversations.current_stage, conversations.ref_link_sent, conversations.ref_link_sent_at, conversations.converted, conversations.converted_at, conversations.messages_count, conversations.user_messages_count, conversations.assistant_messages_count, conversations.avg_response_time, conversations.last_user_message_at, conversations.last_assistant_message_at, conversations.context_summary, conversations.lead_analysis, conversations.is_whitelisted, conversations.is_blacklisted, conversations.auto_created, conversations.requires_approval, conversations.ai_disabled, conversations.auto_responses_paused, conversations.created_at, conversations.updated_at 
FROM conversations 
WHERE conversations.session_id = $1::INTEGER ORDER BY conversations.updated_at DESC 
 LIMIT $2::INTEGER]
[parameters: (8, 10)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-10 02:57:51 | ERROR    | bot.handlers.sessions.sessions:session_manage:154 - ❌ Ошибка управления сессией: invalid literal for int() with base 10: 'man'
2025-06-10 02:57:58 | ERROR    | bot.handlers.sessions.sessions:session_manage:154 - ❌ Ошибка управления сессией: invalid literal for int() with base 10: 'man'
2025-06-10 03:04:50 | ERROR    | bot.handlers.ai_control.ai_control:ai_control_main:90 - ❌ Ошибка меню управления ИИ: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column conversations.ai_disabled does not exist
[SQL: SELECT count(conversations.id) AS count_1 
FROM conversations 
WHERE conversations.status = $1::VARCHAR AND conversations.ai_disabled = false]
[parameters: ('active',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-10 03:04:53 | ERROR    | bot.handlers.ai_control.ai_control:ai_control_main:90 - ❌ Ошибка меню управления ИИ: (sqlalchemy.dialects.postgresql.asyncpg.ProgrammingError) <class 'asyncpg.exceptions.UndefinedColumnError'>: column conversations.ai_disabled does not exist
[SQL: SELECT count(conversations.id) AS count_1 
FROM conversations 
WHERE conversations.status = $1::VARCHAR AND conversations.ai_disabled = false]
[parameters: ('active',)]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-06-10 03:07:04 | ERROR    | bot.handlers.ai_control.ai_control:ai_control_main:90 - ❌ Ошибка меню управления ИИ: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
2025-06-10 03:07:04 | ERROR    | bot.handlers.ai_control.ai_control:ai_control_main:90 - ❌ Ошибка меню управления ИИ: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
2025-06-10 03:07:04 | ERROR    | bot.handlers.ai_control.ai_control:ai_control_main:90 - ❌ Ошибка меню управления ИИ: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
2025-06-10 03:08:12 | ERROR    | bot.handlers.followups.followups:followups_stats:236 - ❌ Ошибка статистики фолоуапов: 'str' object has no attribute '_isnull'
2025-06-10 15:08:39 | ERROR    | bot.handlers.ai_control.ai_control:ai_control_main:90 - ❌ Ошибка меню управления ИИ: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
2025-06-10 15:09:34 | ERROR    | core.engine.conversation_manager:_generate_response:173 - ❌ У сессии llow77 не указан тип персоны
2025-06-10 15:28:28 | ERROR    | workflows.followups.scheduler:schedule_followup_for_inactive_conversation:345 - ❌ Ошибка планирования фолоуапа для неактивного диалога: can't subtract offset-naive and offset-aware datetimes
2025-06-10 16:49:26 | ERROR    | bot.handlers.ai_control.ai_control:ai_control_main:93 - ❌ Ошибка меню управления ИИ: Telegram server says - Bad Request: message is not modified: specified new message content and reply markup are exactly the same as a current content and reply markup of the message
2025-06-10 16:49:40 | ERROR    | bot.handlers.followups.followups:followups_stats:236 - ❌ Ошибка статистики фолоуапов: 'str' object has no attribute '_isnull'
2025-06-10 17:04:25 | ERROR    | core.integrations.openai_client:health_check:195 - ❌ Health check OpenAI провален: Request timed out.
2025-06-10 17:04:25 | ERROR    | __main__:_health_monitor:126 - ❌ Проблемы с OpenAI API!
2025-06-10 19:30:50 | ERROR    | core.integrations.openai_client:health_check:195 - ❌ Health check OpenAI провален: Request timed out.
2025-06-10 19:30:50 | ERROR    | __main__:_health_monitor:126 - ❌ Проблемы с OpenAI API!
2025-06-11 00:37:35 | ERROR    | core.integrations.telegram_client:_check_session_auth:149 - ❌ Ошибка проверки авторизации support: The authorization key (session file) was used under two different IP addresses simultaneously, and can no longer be used. Use the same session exclusively, or use different sessions (caused by InvokeWithLayerRequest(InitConnectionRequest(GetConfigRequest)))
2025-06-11 00:37:55 | ERROR    | core.integrations.telegram_client:_create_client:217 - ❌ Ошибка создания клиента support: The authorization key (session file) was used under two different IP addresses simultaneously, and can no longer be used. Use the same session exclusively, or use different sessions (caused by InvokeWithLayerRequest(InitConnectionRequest(GetConfigRequest)))
2025-06-11 00:37:55 | ERROR    | core.handlers.message_handler:_setup_session_handler:73 - ❌ Не удалось получить клиент для сессии support
2025-06-11 21:14:29 | ERROR    | core.integrations.telegram_client:_create_client:183 - ❌ Файл сессии не найден: support
2025-06-11 21:14:29 | ERROR    | core.handlers.message_handler:_setup_session_handler:73 - ❌ Не удалось получить клиент для сессии support
2025-06-11 21:16:46 | ERROR    | cold_outreach.bot_handlers.template_handlers:templates_create_category:231 - ❌ Ошибка создания шаблона: 'TemplateManager' object has no attribute 'preview_substitution'
2025-06-11 21:22:27 | ERROR    | core.integrations.telegram_client:_create_client:183 - ❌ Файл сессии не найден: support
2025-06-11 21:22:27 | ERROR    | core.handlers.message_handler:_setup_session_handler:73 - ❌ Не удалось получить клиент для сессии support
2025-06-11 21:24:03 | ERROR    | cold_outreach.templates.variable_parser:preview_substitution:235 - ❌ Ошибка предварительного просмотра: asyncio.run() cannot be called from a running event loop
2025-06-11 21:28:11 | ERROR    | core.integrations.telegram_client:_create_client:183 - ❌ Файл сессии не найден: support
2025-06-11 21:28:11 | ERROR    | core.handlers.message_handler:_setup_session_handler:73 - ❌ Не удалось получить клиент для сессии support
2025-06-11 21:38:31 | ERROR    | core.integrations.telegram_client:_create_client:183 - ❌ Файл сессии не найден: support
2025-06-11 21:38:31 | ERROR    | core.handlers.message_handler:_setup_session_handler:73 - ❌ Не удалось получить клиент для сессии support
2025-06-11 21:39:28 | ERROR    | cold_outreach.bot_handlers.main_menu:outreach_campaigns_menu:240 - ❌ Ошибка меню кампаний: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum campaignstatus: "active"
[SQL: SELECT count(outreach_campaigns.id) AS count_1 
FROM outreach_campaigns 
WHERE outreach_campaigns.status = $1::campaignstatus]
[parameters: ('active',)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-06-11 22:09:15 | ERROR    | cold_outreach.bot_handlers.main_menu:outreach_campaigns_menu:240 - ❌ Ошибка меню кампаний: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum campaignstatus: "active"
[SQL: SELECT count(outreach_campaigns.id) AS count_1 
FROM outreach_campaigns 
WHERE outreach_campaigns.status = $1::campaignstatus]
[parameters: ('active',)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-06-11 22:59:05 | ERROR    | core.integrations.openai_client:health_check:195 - ❌ Health check OpenAI провален: Error code: 403 - {'error': {'code': 'unsupported_country_region_territory', 'message': 'Country, region, or territory not supported', 'param': None, 'type': 'request_forbidden'}}
2025-06-11 22:59:05 | ERROR    | __main__:_health_monitor:194 - ❌ Проблемы с OpenAI API!
2025-06-12 01:35:39 | ERROR    | __main__:fix_database_enums:53 - ❌ Ошибка при исправлении БД: Not an executable object: 'DROP TABLE IF EXISTS outreach_messages CASCADE'
2025-06-12 01:46:43 | ERROR    | core.integrations.telegram_client:_create_client:183 - ❌ Файл сессии не найден: support
2025-06-12 01:46:43 | ERROR    | core.handlers.message_handler:_setup_session_handler:73 - ❌ Не удалось получить клиент для сессии support
2025-06-12 01:47:05 | ERROR    | cold_outreach.bot_handlers.main_menu:outreach_campaigns_menu:251 - ❌ Ошибка меню кампаний: (sqlalchemy.dialects.postgresql.asyncpg.Error) <class 'asyncpg.exceptions.InvalidTextRepresentationError'>: invalid input value for enum campaignstatus: "active"
[SQL: SELECT count(outreach_campaigns.id) AS count_1 
FROM outreach_campaigns 
WHERE outreach_campaigns.status = $1::campaignstatus]
[parameters: ('active',)]
(Background on this error at: https://sqlalche.me/e/20/dbapi)
2025-06-12 01:51:50 | ERROR    | core.integrations.telegram_client:_create_client:183 - ❌ Файл сессии не найден: support
2025-06-12 01:51:50 | ERROR    | core.handlers.message_handler:_setup_session_handler:73 - ❌ Не удалось получить клиент для сессии support
2025-06-12 01:52:03 | ERROR    | cold_outreach.bot_handlers.main_menu:outreach_campaigns_menu:252 - ❌ Ошибка меню кампаний: type object 'CampaignStatus' has no attribute 'RUNNING'
2025-06-12 01:53:55 | ERROR    | core.integrations.telegram_client:_create_client:183 - ❌ Файл сессии не найден: support
2025-06-12 01:53:55 | ERROR    | core.handlers.message_handler:_setup_session_handler:73 - ❌ Не удалось получить клиент для сессии support
